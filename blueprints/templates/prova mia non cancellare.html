<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="../static/css/style.css">
    <title>Spotifake</title>
    <link rel="icon" type="image/x-icon" href="../static/img/logo.png">
</head>

<body>
    <!-- Sidebar Content -->
    <div class="w3-sidebar w3-bar-block" style="width:20%; background-color: #1d1d1d;">
        <table style="width:100%">
            <tr> 
              <td style="width:30%" align="center"><a href="{{ url_for('profile_bp.profile') }}"><img src="../static/img/profile.png" style="width:100%;"></a></td>
              <td><a href="{{ url_for('profile_bp.profile') }}">{{user.Name}}</a></td> 
            </tr>
            <tr>
                <td align="center"><a href="{{ url_for('home_bp.home') }}"><img src="../static/img/home.png" style="width:60%;"></a></td>
                <td><a href="{{ url_for('home_bp.home') }}">Home</a></td> 
            </tr>
            <tr> 
                <td align="center"><a href="{{ url_for('find_bp.find') }}"><img src="../static/img/search.png" style="width:60%;"></a></td>
                <td><a href="{{ url_for('find_bp.find') }}">Cerca</a></td> 
            </tr>
            <tr>
                <td align="center"><a href="{{ url_for('library_bp.library') }}"><img src="../static/img/library.png" style="width:60%;"></a></td>
                <td><a href="{{ url_for('library_bp.library') }}">Libreria</a></td> 
            </tr>
            <tr> 
                <td align="center"><a href="{{ url_for('playlist_bp.playlist') }}"><img src="../static/img/add.png" style="width:60%;"></a></td>
                <td><a href="{{ url_for('playlist_bp.playlist') }}">Crea playlist</a></td>
            </tr>
            {% if user.Profile == 'Artist' %}
            <tr>
                <td align="center"><a href="{{ url_for('song_bp.upload_song') }}"><img src="../static/img/add.png" style="width:60%;"></a></td>
                <td><a href="{{ url_for('song_bp.upload_song') }}">Carica brano</a></td> 
            </tr>
            <tr>
                <td align="center"><a href="{{ url_for('album_bp.album') }}"><img src="../static/img/add.png" style="width:60%;"></a></td>
                <td><a href="{{ url_for('album_bp.create_album') }}">Crea album</a></td> 
            </tr>
            <tr>
                <td align="center"><a href="{{ url_for('song_bp.show_my_songs') }}"><img src="../static/img/gallery.png" style="width:60%;"></a></td>
                <td><a href="{{ url_for('song_bp.show_my_songs') }}">Le tue canzoni</a></td> 
            </tr>
            <tr>
                <td align="center"><a href="{{ url_for('album_bp.show_my_albums') }}"><img src="../static/img/gallery.png" style="width:60%;"></a></td>
                <td><a href="{{ url_for('album_bp.show_my_albums') }}">I tuoi album</a></td> 
            </tr>
            <tr> 
                <td align="center"><a href="{{ url_for('stats_bp.stats') }}"><img src="../static/img/chart.png" style="width:60%;"></a></td>
                <td><a href="{{ url_for('stats_bp.stats') }}">Statistiche</a></td>
            </tr>
            {% endif %}
        </table>
        <hr>
        <div class="container">
            {% for p in playlists %}
            <dl>
                <dt> 
                    <a href="{{ url_for('playlist_bp.show_playlist_content', playlist_name=p.Name )}}"> {{p.Name}} </a> 
                </dt>
            </dl>
            {% endfor %}
        </div>
    </div>
      
    <!-- Page Content -->
    <div style="margin-left:20%">
        <div class="w3-container"></div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

        <script type="text/javascript">
            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart);
            
            
            $(window).on("throttledresize", function (event) {
                drawChart();
            });

            function drawChart() {
                var data = new google.visualization.DataTable();
                data.addColumn('string', 'Paesi');
                data.addColumn('number', 'Numero di ascoltatori');
                data.addRows([
                ['Italy', 10],
                ['Germany', 3],
                ['France', 5],
                ['Spain', 4],
                ['Greece', 2]
                ]);

                var options = {
                    title:'Diffusione ascoltatori',
                    titleTextStyle: {
                        color: "rgb(249, 248, 241)",
                        fontName: "Gotham_Regular",    
                        fontSize: 20},
                    legendTextStyle: {
                        color: "rgb(249, 248, 241)",
                        fontName: "Gotham_Light",    
                        fontSize: 15},
                    backgroundColor: 'transparent',
                    width:500,
                    height:300,
                    chartArea: {'width': '98%'},
                };
            
                var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
                chart.draw(data, options);
            }
            $(window).resize(function($event){
                drawChart(data,options);
            });
        </script>

        $.ajax({
            type: 'get'
            url: '{{url_for('stats_bp.get_countries')}}'
            success: function(coso){
                google.charts.load('current', {'packages':['corechart']});
                google.charts.setOnLoadCallback(drawChart);

                function drawChart(){
                    var data = new google.visualization.DataTable();
                    data.addColumn('string', 'Paesi');
                    data.addColumn('number', 'Numero di ascoltatori');
                    for (var i=0; i < coso['data'].length(); i++){
                        data.addRows([
                            [coso['data'][i]['first'], coso['data'][i]['second']]
                        ]);
                    }

                    var options = {
                        title:'Diffusione ascoltatori',
                        titleTextStyle: {
                            color: "rgb(249, 248, 241)",
                            fontName: "Gotham_Regular",    
                            fontSize: 20},
                        legendTextStyle: {
                            color: "rgb(249, 248, 241)",
                            fontName: "Gotham_Light",    
                            fontSize: 15},
                        backgroundColor: 'transparent',
                        width:500,
                        height:300,
                        chartArea: {'width': '98%'},
                    };
                
                    var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
                    chart.draw(data, options);
                }

            }
        })
        
        <div id="chart_div"></div>
    
    </div>
  </body>
</html>